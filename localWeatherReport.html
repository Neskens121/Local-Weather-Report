<!DOCTYPE html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.9/css/weather-icons.min.css" />
	<script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
	<script src="http://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyDM-X-fWiW6i_0xkEOdyJY_kNEdLZTYiDc" type="text/javascript"></script>
	<script>
		// using maxmind API for providing basic user information, city countrycode etc, through one of API methods geoip2.city
		var onSuccess = function(location){
			var city = location['city']['names']['en'];
			var country = location['registered_country']['iso_code'];

			getWeatherInfo(city, country).then(function(result){
				console.log(result)
				var weather = result['list'][1]['weather'][0];
				document.getElementById('weatherIcon').src = 'http://openweathermap.org/img/w/'+ weather['icon'] +'.png';
			})
			
		}
		var onError = function(error){

		};

		//actually you get Promise of WeatherInfo
		function getWeatherInfo(city, country){
			return fetch('http://api.openweathermap.org/data/2.5/forecast?q=' + city + ',' + country + ',&APPID=1606cd61e974fa5479b45020b25cbd13&cnt=4').then(function(response) { 
				return response.json();
			})
		}

		geoip2.city(onSuccess, onError);</script>


	<script type="text/javascript">
	// using Google API for adding autocomplete functionality with generating information, longitude and latitude etc, about city that is being searched
	// solution was found as answer on following post http://stackoverflow.com/questions/13478646/google-map-api-get-latitude-and-longitude-from-autocomplete-without-map
	    function initialize() {
	        var input = document.getElementById('searchTextField');
	        var autocomplete = new google.maps.places.Autocomplete(input);
	        google.maps.event.addListener(autocomplete, 'place_changed', function () {
	            var place = autocomplete.getPlace();
	            document.getElementById('city2').value = place.name;
	            document.getElementById('cityLat').value = place.geometry.location.lat();
	            document.getElementById('cityLng').value = place.geometry.location.lng();
	        });
	    }
	    google.maps.event.addDomListener(window, 'load', initialize); 
	</script>
</head>
<body>
	<div>sabnsa</div>
	<img id ="weatherIcon" src="">
	<div><i class="wi wi-day-snow-thunderstorm"></i></div>
	<input id="searchTextField" type="text" size="50" placeholder="Enter a location" autocomplete="on" runat="server" />  
	<input type="hidden" id="city2" name="city2" />
	<input type="hidden" id="cityLat" name="cityLat" />
	<input type="hidden" id="cityLng" name="cityLng" />  
</body>
</html>